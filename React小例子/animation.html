<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <script src="../lib/react-0.14.0.js"></script>
    <script src="../lib/JSXTransformer.js"></script>
    <script src="../lib/react-with-addons.js"></script>
    <script src="../lib/jquery.min.js"></script>
    <style media="screen" type="text/css">
      div{
        background: #ddd;
      }
      .student-enter {
        opacity: .2;
        transition: opacity 1s;
      }
      .student-enter-active {
        opacity: 1;
      }
      .student-leave {
        transform: scale(1);
        opacity: 1;
        transition: all .5s ease-in;
      }
      .student-leave-active {
        transform: scale(5);
        opacity: 0;
      }
    </style>
  </head>
  <body>
    <div id="example"></div>
    <!--
      jsxTransformer.js专门用来解析js/jsx文件中的jsx语法，而babel不光能干这些还能编译ES6语法等等
    1.JSX是什么
      JSX其实是JavaScript的扩展，React为了代码的可读性更方便地创建虚拟DOM等原因，加入了一些类似XML的语法的扩展。
    2.编译器——jsxTransformer
      JSX代码并不能直接运行，需要将它编译成正常的JavaScript表达式才能运行，jsxTransformer.js就是这一编译器的角色。
    3.第二代编译器——babel
      React官方博客发布了一篇文章，声明其自身用于JSX语法解析的编译器JSTransform已经过期，不再维护，React JS和React Native已经全部采用第三方Babel的JSX编译器实现。
      原因是两者在功能上已经完全重复，而Babel作为专门的JavaScript语法编译工具，提供了更为强大的功能。而browser.js是babel编译器的浏览器版本。非必需引入browser.js
      引入它的作用是使浏览器支持babel,如果你用ES5，可以不引入
    4.babel与jsx
      babel支持将按照ES6写的代码转成ES5格式的代码（编译ES6语法），以便让其能在现代浏览器上正常运行，而用jsx只能用ES5的语法。
  -->
    <script type="text/jsx">
        var ReactCSSTransitionGroup = React.addons.CSSTransitionGroup;
        var Students = React.createClass({
            getInitialState: function() {
              return {
                students: ['amy', 'bob', 'tom', 'lucy']
              };
            },
            componentDidMount: function() {
                var self = this;
                var update = function() {
                  self.setState({
                    students: self.state.students.concat(["unamed-"+parseInt(Math.random()*10000000)])
                  });
                }
                setInterval(update, 1000);
            },
            handleRemove: function(e) {
                var name = $(e.target).data("name");
                var index = 0;
                var students = this.state.students;
                for(var i=0;i<students.length;i++) {
                  if(students[i] == name) index = i;
                }
                this.setState({
                  state: this.state.students.splice(index, 1)
                });
            },
            render: function() {
              var s = this.state.students;
              var self = this;
              return (
                <div>
                  <ReactCSSTransitionGroup transitionName="student">
                  {
                      s.map(function(d, i) {
                        return <div className='student' key={d}>-----{d} ====={i}----<a onClick={self.handleRemove} data-name={d}>删除</a></div>
                      })
                  }
                  </ReactCSSTransitionGroup>
                </div>
                );
            }
        });

        React.render(
            <Students />,
            document.getElementById("example")
        );
    </script>
  </body>
</html>
